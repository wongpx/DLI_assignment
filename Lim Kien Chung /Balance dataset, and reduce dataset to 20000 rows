from sklearn.utils import resample

# Group by 'attack_cat' instead of 'label'
df_list = [df[df['attack_cat'] == i] for i in df['attack_cat'].unique()]
balanced_df = pd.concat([
    resample(group, replace=True, n_samples=2000, random_state=42)
    if len(group) < 2000 else group.sample(2000, random_state=42)
    for group in df_list
])

# Shuffle the final dataset
df = balanced_df.sample(frac=1, random_state=42)
